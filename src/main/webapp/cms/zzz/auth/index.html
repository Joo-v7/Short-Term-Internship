<!doctype html>
<html lang="ko" 
	xmlns:th="http://www.thymeleaf.org" 
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
>
<head>
	<link href="//cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"/>
	<script src="//code.jquery.com/jquery-3.6.1.min.js"></script>
	
	<style>
	body {
		font-family: d2coding, 'Nanum Gothic Coding', 'Malgun Gothic';
		font-size: 0.9rem;
	}
	</style>
</head>
<body>
<div class="container">

<div class="card">
	<div class="card-body">
		<a href="https://docs.spring.io/spring-security/reference/5.7/servlet/authorization/expression-based.html#el-common-built-in">https://docs.spring.io/spring-security/reference/5.7/servlet/authorization/expression-based.html#el-common-built-in</a>
	</div>
</div>

<h3>sec:authorize</h3>
<table class="table table-bordered table-striped table-hover">
	<tr>
		<th>isAnonymous()</th>
		<td class="text-center"><span sec:authorize="isAnonymous()">○</span></td>
	</tr>
	<tr>
		<th>isAuthenticated()</th>
		<td class="text-center"><span sec:authorize="isAuthenticated()">○</span></td>
	</tr>
	<tr>
		<th>hasRole('ROLE_ADMIN')</th>
		<td class="text-center"><span sec:authorize="hasRole('ROLE_ADMIN')">○</span></td>
	</tr>
	<tr>
		<th>hasAnyRole('ROLE_ADMIN', 'ROLE_USER')</th>
		<td class="text-center"><span sec:authorize="hasAnyRole('ROLE_ADMIN', 'ROLE_USER')">○</span></td>
	</tr>
	<tr>
		<th>hasAuthority('CMS_BOARD_R')</th>
		<td class="text-center"><span sec:authorize="hasAuthority('CMS_BOARD_R')">○</span></td>
	</tr>
</table>

<h3>sec:authentication</h3>
<div class="alert alert-primary" sec:authorize="isAnonymous()">
	로그인 후 조회 가능
</div>
<table class="table table-bordered table-striped table-hover" sec:authorize="isAuthenticated()">
	<tr>
		<th>principal</th>
		<td class="text-left"><span sec:authentication="principal"></span></td>
	</tr>
	<tr>
		<th>principal.username</th>
		<td class="text-left"><span sec:authentication="principal.username"></span></td>
	</tr>
	<tr>
		<th>principal.memberId</th>
		<td class="text-left"><span sec:authentication="principal.memberId"></span></td>
	</tr>
	<tr>
		<th>principal.authorities()</th>
		<td class="text-left"><span sec:authentication="principal.authorities"></span></td>
	</tr>
</table>

<div class="card">
	<div class="card-body">
		<a th:href="@{/cms/zzz/auth/isAuthenticated}">/cms/zzz/auth/isAuthenticated</a>
	</div>
</div>

<div class="card">
	<div class="card-body">
		<a th:href="@{/cms/zzz/auth/hasRoleAdmin}">/cms/zzz/auth/hasRoleAdmin</a>
	</div>
</div>

<div class="card">
	<div class="card-body">
		<a th:href="@{/cms/zzz/auth/hasPermission}">/cms/zzz/auth/hasPermission</a>
	</div>
</div>

<div class="card">
	<div class="card-body">
		<a th:href="@{/cms/zzz/auth/hasPermission?myId=1}">/cms/zzz/auth/hasPermission?myId=1</a>
	</div>
</div>



</div>
<!-- // .container -->

</body>
</html>