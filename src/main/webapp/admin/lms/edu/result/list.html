<!doctype html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security" layout:decorate="/pages/admin/layout/common_layout">

<body>

	<th:block layout:fragment="content">

		<style>
			.scroller {
				overflow-y: auto;
			}

			.scroll_defalt {
				max-height: 820px;
			}

			.h2_butt {
				display: block;
				width: 100%;
				height: auto;
				font-size: 18px;
				font-weight: bold;
			}

			.h3_butt {
				display: block;
				width: 100%;
				height: auto;
				font-size: 16px;
				font-weight: bold;
			}

			.collection-item>button {
				display: grid;
				grid-template-areas:
					"title title title"
					"first second second"
					"third third third";
				background-color: transparent;
				border: 0;
				width: 100%;
				height: auto;
				gap: 10px;
				padding: 0;
				grid-template-rows: repeat(3, auto);
				grid-template-columns: 120px repeat(2, auto);
			}

			.collection-item>button>span {
				text-align: left;
				white-space: nowrap;
				overflow: hidden;
				text-overflow: ellipsis;
				white-space: nowrap;
				;
			}

			.collection-item>button .title {
				grid-area: title;
				color: #26a69a;
			}

			.collection-item>button .first {
				grid-area: first;
			}

			.collection-item>button .second {
				grid-area: second;
			}

			.collection-item>button .third {
				grid-area: third;
			}

			.collection-item .none_data {
				display: flex;
				width: 100%;
				height: 100%;
				justify-content: center;
				align-items: center;
			}

			.collection-item:active,
			.collection-item:hover {
				background-color: #26a69a;
				color: #fff;
			}

			.collection-item:active .title,
			.collection-item:hover .title {
				color: #fff;
			}

			.first_info_box {
				display: flex;
				width: 100%;
				height: auto;
				flex-direction: column;
				gap: 10px;
				padding: 10px;
				background-color: #f7f7f7;
				font-size: 16px;
			}

			.first_info_box .tit_name {
				flex: 1;
				width: 100%;
				font-size: 1em;
				font-weight: bold;
				height: auto;
				line-height: 1;
			}

			.first_info_box .info {
				flex: 1;
				display: flex;
				width: 100%;
				height: auto;
				justify-content: flex-start;
				flex-wrap: wrap;
				gap: 10px 20px;
				font-weight: 500;
				color: inherit;
				opacity: 0.8;
				line-height: 1;
			}


			.first_info_box .info .tit {
				flex: 1 1 100%;
				display: block;
				width: 100%;
			}

			.first_info_box .info .cnt {
				flex: 1 1 100%;
				display: block;
				width: 100%;
			}

			.first_info_box .info .inst {
				flex: 0 1 auto;
				width: auto;
			}

			.first_info_box .info .cate {
				flex: 0 1 auto;
				width: auto;
			}

			.left_module_box {
				display: flex;
				margin-top: 10px;
				height: 400px;
				overflow-y: auto;
				position: relative;
				border: 1px solid #e0e0e0;
				padding: 0 !important;
			}

			.left_module_box .module_list {
				display: flex;
				width: 100%;
				height: 100%;
				flex-direction: column;
			}

			.left_module_box .module_list .module-item {
				display: block;
				padding: 0;
			}

			.left_module_box .module_list .module-item>button {
				display: flex;
				width: 100%;
				height: auto;
				padding: 10px;
				flex-direction: column;
				background-color: transparent;
				font-size: 14px;
				border: 0;
				gap: 10px;
			}

			.left_module_box .module_list .module-item .none_data {
				display: flex;
				width: 100%;
				height: auto;
				padding: 20px;
				justify-content: center;
				align-items: center;
				font-size: 1em;
				font-weight: bold;
			}

			.left_module_box .module_list .module-item>button:hover,
			.left_module_box .module_list .module-item>button:focus {
				background-color: #26a69a;
				color: #fff !important;
			}

			.left_module_box .module_list .module-item:not(:first-child)>button {
				border-top: 1px solid #e0e0e0;
			}

			.left_module_box .module_list .module-item>button .module-content {
				flex: 1;
				display: block;
				width: 100%;
				height: auto;
				line-height: 1.5;
				font-size: 1em;
				text-align: left;
				color: #26a69a;
				font-weight: bold;
			}

			.left_module_box .module_list .module-item>button:hover .module-content,
			.left_module_box .module_list .module-item>button:focus .module-content {
				color: #fff;
			}

			.left_module_box .module_list .module-item>button .check-result {
				display: inline-block;
				width: auto;
				font-size: 1em;
				font-size: bold;
				font-weight: bold;
			}

			.left_module_box .module_list .module-item>button .check-result.success {
				color: #4CAF50;
			}

			.left_module_box .module_list .module-item>button .check-result.fail {
				color: #F44336;
			}

			.left_module_box .module_list .module-item>button:hover .check-result,
			.left_module_box .module_list .module-item>button:focus .check-result {
				color: #fff;
			}

			.left_module_box .module_list .module-item>button .playtime {
				display: block;
				width: 100%;
				height: auto;
				font-size: 0.9em;
				font-weight: 500;
				text-align: left;
			}

			.right_table_box {
				height: 400px;
			}

			.table_type3:before {
				display: block;
				margin-bottom: 10px;
				content: "";
			}

		</style>


		<script>
			$(function () {
				// 목록
				$('#frmList').submit(function (e) {
					e.preventDefault();
					dataList();
				});

				// 검색
				$('#frmList').submit();

				//viewEdu(firstDetailIdx);
			});
			function dataList() {
				$.ajax({
					url: gblAdminPath + '/lms/edu/result/listJson?' + $('#frmList').serialize(),
					type: 'GET',
					dataType: "json",
					dataSrc: "data.list",
				}).done(function (data) {
					// 기존 리스트를 비우기
					$('.collection').empty();
					// 새로운 데이터로 리스트 생성 및 추가

					// 첫 번째 생성된 요소의 playIdx 저장
					var firstDetailIdx = null;
					$.each(data.data.list, function (index, item) {
						var liElement = `
				<li class="collection-item" id="${item.detailIdx}">
					<button onclick="viewEdu('${item.detailIdx}')">
						<span class="title"><strong>${item.trainTitle}</strong></span>
						<span class="first">분야 : <strong>${item.eduCateNm}</strong></span>
						<span class="second">교수자 : <strong>${item.teacherNm}</strong></span>
						<span class="third">훈련기간 : <strong>${item.eduTrainBgnDate} ~  ${item.eduTrainEndDate}</strong></span>
					</button>
				</li>
			`;
						// 리스트에 새로운 아이템 추가
						$('.collection').append(liElement);
						
						// 첫 번째 생성된 요소의 modulePlayIdx 저장
						if (index === 0) {
							firstDetailIdx = item.detailIdx;
						}
					})
					// for문이 끝난 후에 첫 번째 생성된 요소의 detailIdx를 사용하여 viewEdu 함수 실행
					if (firstDetailIdx !== null) {
						viewEdu(firstDetailIdx);
					}

				}).fail(function () {
					toast('네트워크 또는 시스템 장애입니다.', 4000);
				})

			}
			function viewEdu(detailIdx) {
				$('.collection-item').removeClass('active');
				document.getElementById(detailIdx).classList.add('active');
				
				$.ajax({
					url: gblAdminPath + "/lms/edu/result/view?detailIdx=" + detailIdx,
					type: 'GET',
					dataType: 'html',
				}).done(function (data) {
					$('#detail_box').empty();
					$('#detail_box').html(data);
				}).fail(function () {
					toast('네트워크 또는 시스템 장애입니다.', 4000);
				});

			}

		</script>
		<div class="row mb0">
			<div class="col s12 m12 l5 xl4 pd_box sideline m0">
				<div class="basic_top_searchbox">
					<form id="frmList" name="frmList" method="get" enctype="multipart/form-data">
						<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

						<div class="row">
							<!-- 검색창 -->
							<div class="col s12 m12 l12 xl12 search_bar">
								<input name="scWord" type="text" class="browser-default" th:value="${param?.scWord}" placeholder="훈련명">
								<input name="scKey2" type="hidden" th:value="${param?.scKey2}">
								<input name="scTeam" type="hidden" th:value="${param?.scTeam}">
								<input name="type" type="hidden" value="memberList">
								<input id="detailIdx" name="detailIdx" type="hidden" th:value="${param?.detailIdx}">

								<input id="file" name="file" type="file" style="display:none;" />

								<button type="submit" class="waves-effect waves-light btn grey darken-2 z-depth-0 left">
									<i class="material-icons md-18 left">search</i> 검색
								</button>
								<div class="title left">
									전체 : <b id="memberTableTotCnt">0</b>
								</div>

							</div>
							<div class="input-field col s12 m12 l6 xl6">
								<label for="eduTrainBgnDate" class="">훈련 시작일자</label>
								<input id="eduTrainBgnDate" name="eduTrainBgnDate" type="date">
							</div>
							<div class="input-field col s12 m12 l6 xl6">
								<label for="eduTrainEndDate" class="">훈련 종료일자</label>
								<input id="eduTrainEndDate" name="eduTrainEndDate" type="date">
							</div>
						</div>
					</form>
				</div>
				<div class="scroller" style="max-height: calc(100vh - 240px);">
					<ul class="collection">
						<!-- 데이터가 없음 -->
						<li class="collection-item" style="display:none">
							<!-- 미검색 -->
							<span class="none_data">검색을 해주십시오.</span>
							<!-- 검색 후 -->
							<!-- <span class="none_data">검색된 결과가 없습니다.</span> -->
						</li>

					</ul>
				</div>
			</div>
			<div class="col s12 m12 l7 xl8 scroller bg_lightblue h100 pd_box" id="detail_box"
				style="max-height: calc(100vh - 108px)">

			</div>
		</div>

</body>

</html>