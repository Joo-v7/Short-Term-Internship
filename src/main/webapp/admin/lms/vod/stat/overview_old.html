<!doctype html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
	layout:decorate="/pages/admin/layout/common_layout">
<body>

<th:block layout:fragment="content">
<style>
#chartdiv {
	width: 100%;
	height: 500px;
}
#chartdiv2 {
	width: 100%;
	height: 500px;
}
#chartdiv3 {
	width: 100%;
	height: 250px;
}
#chartdiv4 {
	width: 100%;
	height: 250px;
}
#chartdiv_timedata_1 {
	width: 100%;
	height: 500px;
}
#chartdiv_timedata_2 {
	width: 100%;
	height: 500px;
}

.evaluation {background-color: #456568!important;}
.satisfaction {background-color: #3d5057!important;}

</style>
<!-- AM 차트 4 -->
<script src="/assets/libs/amchart4/core.js"></script>
<script src="/assets/libs/amchart4/charts.js"></script>
<script src="/assets/libs/amchart4/themes/animated.js"></script>
<script src="/assets/libs/amchart4/plugins/timeline.js"></script>
<script src="/assets/libs/amchart4/plugins/bullets.js"></script>
<script>

// Parse time in HH:MM format to minutes
function parseTime(time) {
	var parts = time.split(":");
	return parseInt(parts[0]) * 60 + parseInt(parts[1]);
}

</script>


<div id="statistics_info_wrap" class="col s12 scroller bg_lightblue h100 pd_box" style="max-height: calc(100vh - 116px); display:block;">
	<div class="row">
		<!-- <div class="input-field col s1">
			<label for="scStartDate" class="active">시작일자</label>
			<input type="date" id="scStartDate" name="scStartDate" value="">
		</div>
		<div class="input-field col s1">
			<label for="scEndDate" class="active">종료일자</label>
			<input type="date" id="scEndDate" name="scEndDate" value="">
		</div>
		<div class="input-field col term_button_list">
			<label for="" class="">현재기준 기간별 조회</label>
			<button class="waves-effect waves-light btn">1개월</button>
			<button class="waves-effect waves-light btn">3개월</button>
			<button class="waves-effect waves-light btn">6개월</button>
			<button class="waves-effect waves-light btn">1년</button>
			<button class="waves-effect waves-light btn">2년</button>
			<button class="waves-effect waves-light btn">3년</button>
		</div> -->
	</div>


	<div class="row">
		<h2 class="h2_butt">통계 정보</h2>
		<div class="row">
			<!-- <div class="helper_text_box">
				<p>훈련시간은 각 모듈의 훈련 예상 시간이며, 수행시간은 실제 훈련자의 수행 시간입니다.</p>							
			</div> -->
			<div class="score_split">
				<dl>
					<dt>평균 평가점수</dt>
					<dd>78</dd>
				</dl>
				<dl>
					<dt>최저 평가점수</dt>
					<dd>65</dd>
				</dl>
				<dl>
					<dt>최고 평가점수</dt>
					<dd>98</dd>
				</dl>
			</div>
		</div>

		

		<div class="row">
			<div class="col s12 m12 l12 xl6">
				<h3 class="h3_butt">전체 평균 이수율</h3>
				<div class="pd_box">
					<div id="chartdiv3"></div>
				</div>
			</div>					
			<div class="col s12 m12 l12 xl6">
				<h3 class="h3_butt">전체 평균 평가점수</h3>
				<div class="pd_box">
					<div id="chartdiv4"></div>
				</div>
			</div>					
		</div>



		
		<div class="row">
			<h3 class="h3_butt">평가/만족도조사 참여 여부</h3>
			<div class="count_wrap">
				<dl class="count_box">
					<dt>학습자</dt>
					<dd>
						1,134,134
						<span>명</span>
					</dd>
				</dl>
				<dl class="count_box">
					<dt class="evaluation">평가</dt>
					<dd>
						234,134
						<span>참여</span>
					</dd>
				</dl>
				<dl class="count_box">
					<dt class="satisfaction">만족도</dt>
					<dd>
						234,134
						<span>참여</span>
					</dd>
				</dl>
			</div>
		</div>
		<!-- <div class="row">
			<h3 class="h3_butt">이벤트 발생 분포도</h3>
			<div class="pd_box">
				<div id="chartdiv2"></div>
			</div>
		</div> -->

		<div class="row">
			<h3 class="h3_butt mb20">기간별 학습자 영상교육 시청 추이</h3>
			<div class="col s12">
				<!-- <div class="input-field col s1">
					<label for="scStartDate" class="active">시작일자</label>
					<input type="date" id="scStartDate" name="scStartDate" value="">
				</div>
				<div class="input-field col s1">
					<label for="scEndDate" class="active">종료일자</label>
					<input type="date" id="scEndDate" name="scEndDate" value="">
				</div> -->
				<div class="input-field col term_button_list">
					<button class="waves-effect waves-light btn" id="timedata_1">1개월</button>
					<button class="waves-effect waves-light btn" id="timedata_2">3개월</button>
					<button class="waves-effect waves-light btn" id="timedata_3">6개월</button>
					<button class="waves-effect waves-light btn" id="timedata_4">1년</button>
					<button class="waves-effect waves-light btn" id="timedata_5">2년</button>
					<button class="waves-effect waves-light btn" id="timedata_6">3년</button>
				</div>
			</div>
			<div class="pd_box">
				<div id="chartdiv_timedata_1"></div>
			</div>
		</div>

		
		<div class="row">
			<h3 class="h3_butt mb20">연간 평가 점수 추이</h3>
			<div class="pd_box">
				<div id="chartdiv_timedata_2"></div>
			</div>
		</div>


	</div>
	
</div>


<div id="training_data_info_wrap" class="col s12 scroller pd_box h100" style="max-height: calc(100vh - 116px); display:none">

	<div class="row mt20">
		<div class="table_type3">

			<table class="dataTable striped centered highlight " style="min-width: 1000px">
				<colgroup>
					<col width="140px">
					<col width="120px">
					<col width="auto">
					<col width="120px">
					<col width="120px">
					<col width="120px">
				</colgroup>
				<thead>
					<tr>
						<th>훈련자 ID</th>
						<th>성명</th>
						<th>명칭</th>
						<th>총 시청시간</th>
						<th>재시험 수</th>
						<th>이수 여부</th>
						<th>평가 점수</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td class="dt-body-center">galaxyTrain_999</td>
						<td class="dt-body-center">철이</td>
						<td class="dt-body-center">활선용 완철사용 사전작업</td>
						<td class="dt-body-center">1:23:43</td>
						<td class="dt-body-center">0</td>
						<td class="dt-body-center">이수</td>
						<td class="dt-body-center">98점</td>
					</tr>
					<tr>
						<td class="dt-body-center">sword_master</td>
						<td class="dt-body-center">고길동</td>
						<td class="dt-body-center">공사현장 안전사고 사례 및 예방대책</td>
						<td class="dt-body-center">0:56:42</td>
						<td class="dt-body-center">0</td>
						<td class="dt-body-center">-</td>
						<td class="dt-body-center">-</td>
					</tr>
					<tr>
						<td class="dt-body-center">monkey</td>
						<td class="dt-body-center">손오공</td>
						<td class="dt-body-center">지중송전 케이블 설계 기초</td>
						<td class="dt-body-center">0:45:35</td>
						<td class="dt-body-center">2</td>
						<td class="dt-body-center">-</td>
						<td class="dt-body-center">54점</td>
					</tr>
					<tr>
						<td class="dt-body-center">monster_king</td>
						<td class="dt-body-center">마동석</td>
						<td class="dt-body-center">계측기 사용방법</td>
						<td class="dt-body-center">1:02:43</td>
						<td class="dt-body-center">1</td>
						<td class="dt-body-center">이수</td>
						<td class="dt-body-center">87점</td>
					</tr>
				</tbody>
			</table>
		</div>
	</div>

			
	<div class="row">
		<div class="col s12 m12 l12 xl3">
			<h3 class="h3_butt mt20 mb10">평가시험 재시험율</h3>
			<div id="chartdiv_personal_1" style="width: 100%; height:240px"></div>
		</div>
		<div class="col s12 m12 l12 xl3">
			<h3 class="h3_butt mt20 mb10">재시험자 및 고득점자 수 비교</h3>
			<div id="chartdiv_personal_2" style="width: 100%; height:240px"></div>
		</div>
		<div class="col s12 m12 l12 xl6">
			<h3 class="h3_butt mt20 mb10">고득점 격차 비교 Top 3</h3>
			<div id="chartdiv_personal_3" style="width: 100%; height:240px"></div>
		</div>
	</div>
</div>
<script>
	$(function() {
		var once = 0;
		document.querySelector('#training_data_info_wrap').style.display = 'none';
		vodViewChart();
		avgPass();
		avgScore();
		avgScoreTrend();
		retestRate();
		retesterAndHighScorer();
		gapComparison();
		
	
	});
function vodViewChart(){ // chartdiv_timedata_1 기간별 학습자 영상교육 시청 추이
	$.ajax({
        url: gblAdminPath + "/lms/vod/stat/chart/vodViewChart",
        type: 'GET',
        dataType: 'json',
    }).done(function (data) {
		
		am4core.ready(function() {
		
		// Themes begin
		am4core.useTheme(am4themes_animated);
		// Themes end
		
		// Create chart instance
		var chart = am4core.create("chartdiv_timedata_1", am4charts.XYChart);
		//chart.logo.disabled = true;
		
		// Add data
		chart.data = [{
		  "teom": "1주차",
		  "v_count": 6876,
		  "rv_count": 8978,
		  "test_count": 5643,
		}, {
		  "teom": "2주차",
		  "v_count": 8678,
		  "rv_count": 5674,
		  "test_count": 4563,
		}, {
		  "teom": "3주차",
		  "v_count": 5677,
		  "rv_count": 4563,
		  "test_count": 5463,
		}, {
		  "teom": "4주차",
		  "v_count": 3453,
		  "rv_count": 6564,
		  "test_count": 3452,
		}];
		
		// Create axes
		var categoryAxis = chart.xAxes.push(new am4charts.CategoryAxis());
		categoryAxis.dataFields.category = "teom";
		categoryAxis.renderer.minGridDistance = 30;
		
		
		var valueAxis = chart.yAxes.push(new am4charts.ValueAxis());
		// valueAxis.renderer.inside = true;
		// valueAxis.renderer.labels.template.disabled = true;
		valueAxis.min = 0;
		
		
		// Create series
		function createSeries(field, name, color) {
		 // Set up series
		 var series = chart.series.push(new am4charts.LineSeries());
		  series.name = name;
		  series.dataFields.valueY = field;
		  series.dataFields.categoryX = "teom";
		  series.sequencedInterpolation = true;
		  series.tooltipText = "[bold]{name}[/]\n{valueY}";
		  series.stroke = am4core.color(color);
		  series.minBulletDistance = 15;
		
		  // Drop-shaped tooltips
		  series.tooltip.getFillFromObject = false;
		//   series.tooltip.background.fill = am4core.color("#000");
		  series.tooltip.background.fill = am4core.color(color);
		  series.tooltip.background.strokeOpacity = 0;
		  series.tooltip.pointerOrientation = "vertical";
		  series.tooltip.label.minWidth = 40;
		  series.tooltip.label.minHeight = 40;
		  series.tooltip.label.textAlign = "middle";
		  series.tooltip.label.textValign = "middle";
		
		  // Make bullets grow on hover
		  var bullet = series.bullets.push(new am4charts.CircleBullet());
		  bullet.circle.strokeWidth = 2;
		  bullet.circle.radius = 4;
		  bullet.circle.fill = am4core.color("#fff");
		  var bullethover = bullet.states.create("hover");
		  bullethover.properties.scale = 1.3;
		
		  return series;
		}
		
		createSeries("v_count", "영상 시청 수", '#13254a');
		createSeries("test_count", "만족도 참여 수", '#007387');
		createSeries("rv_count", "평가 참여 수", '#00a0c3');
		
		
		// Make a panning cursor
		chart.cursor = new am4charts.XYCursor();
		chart.cursor.behavior = "panXY";
		
		
		
		// Legend
		chart.legend = new am4charts.Legend();
		
			// 차트 데이터 변경
			document.getElementById('timedata_1').addEventListener('click', ()=>{	// 1개월
				chart.data = [{
				"teom": "1주차",
				"v_count": 6876,
				"rv_count": 8978,
				"test_count": 5643,
				}, {
				"teom": "2주차",
				"v_count": 8678,
				"rv_count": 5674,
				"test_count": 4563,
				}, {
				"teom": "3주차",
				"v_count": 5677,
				"rv_count": 4563,
				"test_count": 5463,
				}, {
				"teom": "4주차",
				"v_count": 3453,
				"rv_count": 6564,
				"test_count": 3452,
				}];
			});
			document.getElementById('timedata_2').addEventListener('click', ()=>{	// 3개월
				chart.data = [{
				"teom": "1주차",
				"v_count": 5475,
				"rv_count": 5674,
				"test_count": 5647,
				}, {
				"teom": "2주차",
				"v_count": 5674,
				"rv_count": 3647,
				"test_count": 5764,
				}, {
				"teom": "3주차",
				"v_count": 8674,
				"rv_count": 3564,
				"test_count": 3644,
				}, {
				"teom": "4주차",
				"v_count": 5678,
				"rv_count": 4633,
				"test_count": 5432,
				}, {
				"teom": "5주차",
				"v_count": 6534,
				"rv_count": 5674,
				"test_count": 8347,
				}, {
				"teom": "6주차",
				"v_count": 4563,
				"rv_count": 7625,
				"test_count": 6438,
				}, {
				"teom": "7주차",
				"v_count": 5614,
				"rv_count": 5627,
				"test_count": 6438,
				}, {
				"teom": "8주차",
				"v_count": 7556,
				"rv_count": 4656,
				"test_count": 6437,
				}, {
				"teom": "9주차",
				"v_count": 4235,
				"rv_count": 5637,
				"test_count": 5246,
				}, {
				"teom": "10주차",
				"v_count": 6715,
				"rv_count": 4356,
				"test_count": 8437,
				}, {
				"teom": "11주차",
				"v_count": 5367,
				"rv_count": 5461,
				"test_count": 5643,
				}, {
				"teom": "12주차",
				"v_count": 7356,
				"rv_count": 4456,
				"test_count": 7845,
				}];
			});
			document.getElementById('timedata_3').addEventListener('click', ()=>{	// 6개월
				chart.data = [{
				"teom": "1개월차",
				"v_count": 12331,
				"rv_count": 17245,
				"test_count": 24433,
				}, {
				"teom": "2개월차",
				"v_count": 16412,
				"rv_count": 13246,
				"test_count": 36425,
				}, {
				"teom": "3개월차",
				"v_count": 11615,
				"rv_count": 14546,
				"test_count": 18334,
				}, {
				"teom": "4개월차",
				"v_count": 15534,
				"rv_count": 16524,
				"test_count": 25453,
				}, {
				"teom": "5개월차",
				"v_count": 13366,
				"rv_count": 16457,
				"test_count": 24541,
				}, {
				"teom": "6개월차",
				"v_count": 14546,
				"rv_count": 17646,
				"test_count": 24354,
				}];
			});
			document.getElementById('timedata_4').addEventListener('click', ()=>{	// 1년
				chart.data = [{
				"teom": "1개월차",
				"v_count": 12331,
				"rv_count": 17245,
				"test_count": 24433,
				}, {
				"teom": "2개월차",
				"v_count": 16412,
				"rv_count": 13246,
				"test_count": 36425,
				}, {
				"teom": "3개월차",
				"v_count": 11615,
				"rv_count": 14546,
				"test_count": 18334,
				}, {
				"teom": "4개월차",
				"v_count": 15534,
				"rv_count": 16524,
				"test_count": 25453,
				}, {
				"teom": "5개월차",
				"v_count": 13366,
				"rv_count": 16457,
				"test_count": 24541,
				}, {
				"teom": "6개월차",
				"v_count": 14546,
				"rv_count": 17646,
				"test_count": 24354,
				}, {
				"teom": "7개월차",
				"v_count": 11525,
				"rv_count": 14655,
				"test_count": 18767,
				}, {
				"teom": "8개월차",
				"v_count": 12653,
				"rv_count": 16737,
				"test_count": 24571,
				}, {
				"teom": "9개월차",
				"v_count": 16156,
				"rv_count": 12473,
				"test_count": 18546,
				}, {
				"teom": "10개월차",
				"v_count": 10623,
				"rv_count": 13172,
				"test_count": 15678,
				}, {
				"teom": "11개월차",
				"v_count": 9676,
				"rv_count": 13756,
				"test_count": 18674,
				}, {
				"teom": "12개월차",
				"v_count": 5656,
				"rv_count": 17456,
				"test_count": 12345,
				}];
			});
			document.getElementById('timedata_5').addEventListener('click', ()=>{	// 2년
				chart.data = [{
				"teom": "1",
				"v_count": 12431,
				"rv_count": 17465,
				"test_count": 24933,
				}, {
				"teom": "2",
				"v_count": 16512,
				"rv_count": 13236,
				"test_count": 36545,
				}, {
				"teom": "3",
				"v_count": 11261,
				"rv_count": 14356,
				"test_count": 18453,
				}, {
				"teom": "4",
				"v_count": 15234,
				"rv_count": 16544,
				"test_count": 25633,
				}, {
				"teom": "5",
				"v_count": 13646,
				"rv_count": 16357,
				"test_count": 22341,
				}, {
				"teom": "6",
				"v_count": 14556,
				"rv_count": 18676,
				"test_count": 25434,
				}, {
				"teom": "7",
				"v_count": 11425,
				"rv_count": 14565,
				"test_count": 18567,
				}, {
				"teom": "8",
				"v_count": 12563,
				"rv_count": 16736,
				"test_count": 20761,
				}, {
				"teom": "9",
				"v_count": 11586,
				"rv_count": 12453,
				"test_count": 5186,
				}, {
				"teom": "10",
				"v_count": 10235,
				"rv_count": 13142,
				"test_count": 17348,
				}, {
				"teom": "11",
				"v_count": 9526,
				"rv_count": 13736,
				"test_count": 18654,
				}, {
				"teom": "12",
				"v_count": 7536,
				"rv_count": 11746,
				"test_count": 16525,
				}, {
				"teom": "13",
				"v_count": 6544,
				"rv_count": 16543,
				"test_count": 8776,
				}, {
				"teom": "14",
				"v_count": 5756,
				"rv_count": 11244,
				"test_count": 6534,
				}, {
				"teom": "15",
				"v_count": 6564,
				"rv_count": 8576,
				"test_count": 7546,
				}, {
				"teom": "16",
				"v_count": 5627,
				"rv_count": 7356,
				"test_count": 647,
				}, {
				"teom": "17",
				"v_count": 6775,
				"rv_count": 5667,
				"test_count": 6453,
				}, {
				"teom": "18",
				"v_count": 5634,
				"rv_count": 8746,
				"test_count": 5656,
				}, {
				"teom": "19",
				"v_count": 5346,
				"rv_count": 7576,
				"test_count": 657,
				}, {
				"teom": "20",
				"v_count": 5776,
				"rv_count": 8687,
				"test_count": 9676,
				}, {
				"teom": "21",
				"v_count": 3458,
				"rv_count": 4357,
				"test_count": 4645,
				}, {
				"teom": "22",
				"v_count": 2354,
				"rv_count": 5464,
				"test_count": 4376,
				}, {
				"teom": "23",
				"v_count": 2443,
				"rv_count": 2453,
				"test_count": 1763,
				}, {
				"teom": "24",
				"v_count": 1362,
				"rv_count": 2743,
				"test_count": 1340,
				}];
			});
			document.getElementById('timedata_5').addEventListener('click', ()=>{	// 3년
				chart.data = [{
				"teom": "1",
				"v_count": 12331,
				"rv_count": 17545,
				"test_count": 2243,
				}, {
				"teom": "2",
				"v_count": 16152,
				"rv_count": 13426,
				"test_count": 3365,
				}, {
				"teom": "3",
				"v_count": 11641,
				"rv_count": 14256,
				"test_count": 4583,
				}, {
				"teom": "4",
				"v_count": 15334,
				"rv_count": 16554,
				"test_count": 5253,
				}, {
				"teom": "5",
				"v_count": 13646,
				"rv_count": 16657,
				"test_count": 8741,
				}, {
				"teom": "6",
				"v_count": 14356,
				"rv_count": 14876,
				"test_count": 6234,
				}, {
				"teom": "7",
				"v_count": 11255,
				"rv_count": 14255,
				"test_count": 5187,
				}, {
				"teom": "8",
				"v_count": 12263,
				"rv_count": 16733,
				"test_count": 3201,
				}, {
				"teom": "9",
				"v_count": 11546,
				"rv_count": 12423,
				"test_count": 2186,
				}, {
				"teom": "10",
				"v_count": 10523,
				"rv_count": 13312,
				"test_count": 2178,
				}, {
				"teom": "11",
				"v_count": 9556,
				"rv_count": 13476,
				"test_count": 3184,
				}, {
				"teom": "12",
				"v_count": 7536,
				"rv_count": 15176,
				"test_count": 4125,
				}, {
				"teom": "13",
				"v_count": 6554,
				"rv_count": 15343,
				"test_count": 3487,
				}, {
				"teom": "14",
				"v_count": 5276,
				"rv_count": 14124,
				"test_count": 2365,
				}, {
				"teom": "15",
				"v_count": 6534,
				"rv_count": 8476,
				"test_count": 5476,
				}, {
				"teom": "16",
				"v_count": 5367,
				"rv_count": 7546,
				"test_count": 2367,
				}, {
				"teom": "17",
				"v_count": 6575,
				"rv_count": 5467,
				"test_count": 4363,
				}, {
				"teom": "18",
				"v_count": 5264,
				"rv_count": 8476,
				"test_count": 3156,
				}, {
				"teom": "19",
				"v_count": 5234,
				"rv_count": 7356,
				"test_count": 3267,
				}, {
				"teom": "20",
				"v_count": 5476,
				"rv_count": 8267,
				"test_count": 5476,
				}, {
				"teom": "21",
				"v_count": 3435,
				"rv_count": 2435,
				"test_count": 2345,
				}, {
				"teom": "22",
				"v_count": 2534,
				"rv_count": 5364,
				"test_count": 4323,
				}, {
				"teom": "23",
				"v_count": 2453,
				"rv_count": 2443,
				"test_count": 1433,
				}, {
				"teom": "24",
				"v_count": 1232,
				"rv_count": 3243,
				"test_count": 3210,
				}];
			});
		
		
		}); // end am4core.ready()

		
    }).fail(function () {
		console.log("기간별 위험요인 발생추이를 불러오지 못했습니다.");
    });
}
function avgPass(){ //chartdiv3 전체 평균 이수율
	$.ajax({
        url: gblAdminPath + "/lms/vod/stat/chart/avgPass",
        type: 'GET',
        dataType: 'json',
    }).done(function (data) {
		
		am4core.ready(function() {
		
		// Themes begin
		am4core.useTheme(am4themes_animated);
		// Themes end
		var chartMin = 0;
		var chartMax = 100;
		
		var data = {
		  score: 68.2,
		  gradingData: [
			{
		      title: "경고",
		      color: "#ee1f25",
		      lowScore: 0,
		      highScore: 25
		    },
		    {
		      title: "저조",
		      color: "#f3eb0c",
		      lowScore: 25,
		      highScore: 50
		    },
		    {
		      title: "양호",
		      color: "#9ED136",
		      lowScore: 50,
		      highScore: 75
		    },
		    {
		      title: "우수",
		      color: "#0f9747",
		      lowScore: 75,
		      highScore: 100
		    }
		  ]
		};
		
		
		/**
		Grading Lookup
		 */
		function lookUpGrade(lookupScore, grades) {
		  // Only change code below this line
		  for (var i = 0; i < grades.length; i++) {
		    if (
		      grades[i].lowScore < lookupScore &&
		      grades[i].highScore >= lookupScore
		    ) {
		      return grades[i];
		    }
		  }
		  return null;
		}
		// create chart
		var chart = am4core.create("chartdiv3", am4charts.GaugeChart);
		//chart.logo.disabled = true;
		chart.hiddenState.properties.opacity = 0;
		chart.fontSize = 14;
		chart.innerRadius = am4core.percent(80);
		chart.resizable = true;
		
		/**
		 * Normal axis
		 */
		
		var axis = chart.xAxes.push(new am4charts.ValueAxis());
		axis.min = chartMin;
		axis.max = chartMax;
		axis.strictMinMax = true;
		axis.renderer.radius = am4core.percent(80);
		axis.renderer.inside = true;
		axis.renderer.line.strokeOpacity = 0.1;
		axis.renderer.ticks.template.disabled = false;
		axis.renderer.ticks.template.strokeOpacity = 1;
		axis.renderer.ticks.template.strokeWidth = 0.5;
		axis.renderer.ticks.template.length = 5;
		axis.renderer.grid.template.disabled = true;
		axis.renderer.labels.template.radius = am4core.percent(15);
		axis.renderer.labels.template.fontSize = "0.9em";
		
		/**
		 * Axis for ranges
		 */
		
		var axis2 = chart.xAxes.push(new am4charts.ValueAxis());
		axis2.min = chartMin;
		axis2.max = chartMax;
		axis2.strictMinMax = true;
		axis2.renderer.labels.template.disabled = true;
		axis2.renderer.ticks.template.disabled = true;
		axis2.renderer.grid.template.disabled = false;
		axis2.renderer.grid.template.opacity = 0.8;
		axis2.renderer.labels.template.bent = true;
		axis2.renderer.labels.template.fill = am4core.color("#000");
		axis2.renderer.labels.template.fontWeight = "bold";
		axis2.renderer.labels.template.fillOpacity = 0.5;
		
		
		
		/**
		Ranges
		*/
		
		for (let grading of data.gradingData) {
		  var range = axis2.axisRanges.create();
		  range.axisFill.fill = am4core.color(grading.color);
		  range.axisFill.fillOpacity = 0.8;
		  range.axisFill.zIndex = -1;
		  range.value = grading.lowScore > chartMin ? grading.lowScore : chartMin;
		  range.endValue = grading.highScore < chartMax ? grading.highScore : chartMax;
		  range.grid.strokeOpacity = 0;
		  range.stroke = am4core.color(grading.color).lighten(-0.1);
		  range.label.inside = true;
		  range.label.text = grading.title.toUpperCase();
		  range.label.inside = true;
		  range.label.location = 0.5;
		  range.label.inside = true;
		  range.label.radius = am4core.percent(10);
		  range.label.paddingBottom = -5; // ~half font size
		  range.label.fontSize = "0.9em";
		}
		
		var matchingGrade = lookUpGrade(data.score, data.gradingData);
		
		/**
		 * Label 1
		 */
		
		var label = chart.radarContainer.createChild(am4core.Label);
		label.isMeasured = false;
		label.fontSize = "3em";
		label.x = am4core.percent(50);
		label.paddingBottom = 15;
		label.horizontalCenter = "middle";
		label.verticalCenter = "bottom";
		//label.dataItem = data;
		label.text = data.score.toFixed(1);
		label.fontWeight = "bold";
		//label.text = "{score}";
		// label.fill = am4core.color(matchingGrade.color);
		label.fill = am4core.color("#212121");
		
		/**
		 * Label 2
		 */
		
		var label2 = chart.radarContainer.createChild(am4core.Label);
		label2.isMeasured = false;
		label2.fontSize = "1.4em";
		label2.horizontalCenter = "middle";
		label2.verticalCenter = "bottom";
		label2.text = matchingGrade.title.toUpperCase();
		label2.fill = am4core.color(matchingGrade.color);
		
		
		/**
		 * Hand
		 */
		
		var hand = chart.hands.push(new am4charts.ClockHand());
		hand.axis = axis2;
		hand.innerRadius = am4core.percent(55);
		hand.startWidth = 8;
		hand.pin.disabled = true;
		hand.value = data.score;
		hand.fill = am4core.color("#444");
		hand.stroke = am4core.color("#000");
		
		hand.events.on("positionchanged", function(){
		  label.text = axis2.positionToValue(hand.currentPosition).toFixed(1);
		  var value2 = axis.positionToValue(hand.currentPosition);
		  var matchingGrade = lookUpGrade(axis.positionToValue(hand.currentPosition), data.gradingData);
		  label2.text = matchingGrade.title.toUpperCase();
		  label2.fill = am4core.color(matchingGrade.color);
		  label2.stroke = am4core.color(matchingGrade.color);  
		  label.fill = am4core.color(matchingGrade.color);
		})
		
		// setInterval(function() {
		//     var value = chartMin + Math.random() * (chartMax - chartMin);
		//     hand.showValue(value, 1000, am4core.ease.cubicOut);
		// }, 2000);
		
		}); // end am4core.ready()

		
    }).fail(function () {
		console.log("평균 근육 활성도를 불러오지 못했습니다.");
    });
}
function avgScore(){ // chartdiv4 전체 평균 평가점수
	$.ajax({
        url: gblAdminPath + "/lms/vod/stat/chart/avgScore",
        type: 'GET',
        dataType: 'json',
    }).done(function (data) {
		
		am4core.ready(function() {
		
		// Themes begin
		am4core.useTheme(am4themes_animated);
		// Themes end
		var chartMin = 0;
		var chartMax = 100;
		
		var data = {
		  score: 78.8,
		  gradingData: [
		    {
		      title: "경고",
		      color: "#ee1f25",
		      lowScore: 0,
		      highScore: 25
		    },
		    {
		      title: "저조",
		      color: "#f3eb0c",
		      lowScore: 25,
		      highScore: 50
		    },
		    {
		      title: "양호",
		      color: "#9ED136",
		      lowScore: 50,
		      highScore: 75
		    },
		    {
		      title: "우수",
		      color: "#0f9747",
		      lowScore: 75,
		      highScore: 100
		    }
		  ]
		};
		
		
		/**
		Grading Lookup
		 */
		function lookUpGrade(lookupScore, grades) {
		  // Only change code below this line
		  for (var i = 0; i < grades.length; i++) {
		    if (
		      grades[i].lowScore < lookupScore &&
		      grades[i].highScore >= lookupScore
		    ) {
		      return grades[i];
		    }
		  }
		  return null;
		}
		// create chart
		var chart = am4core.create("chartdiv4", am4charts.GaugeChart);
		chart.hiddenState.properties.opacity = 0;
		chart.fontSize = 14;
		chart.innerRadius = am4core.percent(80);
		chart.resizable = true;
		//chart.logo.disabled = true;
		/**
		 * Normal axis
		 */
		
		var axis = chart.xAxes.push(new am4charts.ValueAxis());
		axis.min = chartMin;
		axis.max = chartMax;
		axis.strictMinMax = true;
		axis.renderer.radius = am4core.percent(80);
		axis.renderer.inside = true;
		axis.renderer.line.strokeOpacity = 0.1;
		axis.renderer.ticks.template.disabled = false;
		axis.renderer.ticks.template.strokeOpacity = 1;
		axis.renderer.ticks.template.strokeWidth = 0.5;
		axis.renderer.ticks.template.length = 5;
		axis.renderer.grid.template.disabled = true;
		axis.renderer.labels.template.radius = am4core.percent(15);
		axis.renderer.labels.template.fontSize = "0.9em";
		
		/**
		 * Axis for ranges
		 */
		
		var axis2 = chart.xAxes.push(new am4charts.ValueAxis());
		axis2.min = chartMin;
		axis2.max = chartMax;
		axis2.strictMinMax = true;
		axis2.renderer.labels.template.disabled = true;
		axis2.renderer.ticks.template.disabled = true;
		axis2.renderer.grid.template.disabled = false;
		axis2.renderer.grid.template.opacity = 0.8;
		axis2.renderer.labels.template.bent = true;
		axis2.renderer.labels.template.fill = am4core.color("#000");
		axis2.renderer.labels.template.fontWeight = "bold";
		axis2.renderer.labels.template.fillOpacity = 0.5;
		
		
		
		/**
		Ranges
		*/
		
		for (let grading of data.gradingData) {
		  var range = axis2.axisRanges.create();
		  range.axisFill.fill = am4core.color(grading.color);
		  range.axisFill.fillOpacity = 0.8;
		  range.axisFill.zIndex = -1;
		  range.value = grading.lowScore > chartMin ? grading.lowScore : chartMin;
		  range.endValue = grading.highScore < chartMax ? grading.highScore : chartMax;
		  range.grid.strokeOpacity = 0;
		  range.stroke = am4core.color(grading.color).lighten(-0.1);
		  range.label.inside = true;
		  range.label.text = grading.title.toUpperCase();
		  range.label.inside = true;
		  range.label.location = 0.5;
		  range.label.inside = true;
		  range.label.radius = am4core.percent(10);
		  range.label.paddingBottom = -5; // ~half font size
		  range.label.fontSize = "0.9em";
		}
		
		var matchingGrade = lookUpGrade(data.score, data.gradingData);
		
		/**
		 * Label 1
		 */
		
		var label = chart.radarContainer.createChild(am4core.Label);
		label.isMeasured = false;
		label.fontSize = "3em";
		label.x = am4core.percent(50);
		label.paddingBottom = 15;
		label.horizontalCenter = "middle";
		label.verticalCenter = "bottom";
		//label.dataItem = data;
		label.text = data.score.toFixed(1);
		label.fontWeight = "bold";
		//label.text = "{score}";
		label.fill = am4core.color(matchingGrade.color);
		
		/**
		 * Label 2
		 */
		
		var label2 = chart.radarContainer.createChild(am4core.Label);
		label2.isMeasured = false;
		label2.fontSize = "1.4em";
		label2.horizontalCenter = "middle";
		label2.verticalCenter = "bottom";
		label2.text = matchingGrade.title.toUpperCase();
		label2.fill = am4core.color(matchingGrade.color);
		
		
		/**
		 * Hand
		 */
		
		var hand = chart.hands.push(new am4charts.ClockHand());
		hand.axis = axis2;
		hand.innerRadius = am4core.percent(55);
		hand.startWidth = 8;
		hand.pin.disabled = true;
		hand.value = data.score;
		hand.fill = am4core.color("#444");
		hand.stroke = am4core.color("#000");
		
		hand.events.on("positionchanged", function(){
		  label.text = axis2.positionToValue(hand.currentPosition).toFixed(1);
		  var value2 = axis.positionToValue(hand.currentPosition);
		  var matchingGrade = lookUpGrade(axis.positionToValue(hand.currentPosition), data.gradingData);
		  label2.text = matchingGrade.title.toUpperCase();
		  label2.fill = am4core.color(matchingGrade.color);
		  label2.stroke = am4core.color(matchingGrade.color);  
		  label.fill = am4core.color(matchingGrade.color);
		})
		
		// setInterval(function() {
		//     var value = chartMin + Math.random() * (chartMax - chartMin);
		//     hand.showValue(value, 1000, am4core.ease.cubicOut);
		// }, 2000);
		
		}); // end am4core.ready()
				
    }).fail(function () {
		console.log("평균 추락 위험도를 불러오지 못했습니다.");
    });
}
function avgScoreTrend(){ // chartdiv_timdata_2 // 연간 평가 점수 추이
	$.ajax({
        url: gblAdminPath + "/lms/vod/stat/chart/avgScoreTrend",
        type: 'GET',
        dataType: 'json',
    }).done(function (data) {
		
		am4core.ready(function() {
		
		// Themes begin
		am4core.useTheme(am4themes_animated);
		// Themes end
		
		// Create chart instance
		var chart = am4core.create("chartdiv_timedata_2", am4charts.XYChart);
		//chart.logo.disabled = true;
		// 사고이벤트 object_factor 값
		// Add data
		chart.data = [{
			"teom": "1월",
			"score_1": 98,
			"score_2": 87,
			"score_3": 68,
			}, {
			"teom": "2월",
			"score_1": 95,
			"score_2": 87,
			"score_3": 67,
			}, {
			"teom": "3월",
			"score_1": 86,
			"score_2": 76,
			"score_3": 56,
			}, {
			"teom": "4월",
			"score_1": 87,
			"score_2": 67,
			"score_3": 57,
			}, {
			"teom": "5월",
			"score_1": 87,
			"score_2": 87,
			"score_3": 87,
			}, {
			"teom": "6월",
			"score_1": 98,
			"score_2": 79,
			"score_3": 67,
			}, {
			"teom": "7월",
			"score_1": 87,
			"score_2": 78,
			"score_3": 62,
			}, {
			"teom": "8월",
			"score_1": 87,
			"score_2": 79,
			"score_3": 64,
			}, {
			"teom": "9월",
			"score_1": 87,
			"score_2": 74,
			"score_3": 67,
			}, {
			"teom": "10월",
			"score_1": 89,
			"score_2": 67,
			"score_3": 54,
			}, {
			"teom": "11월",
			"score_1": 87,
			"score_2": 67,
			"score_3": 35,
			}, {
			"teom": "12월",
			"score_1": 94,
			"score_2": 65,
			"score_3": 25,
			}];
		
		// Create axes
		var categoryAxis = chart.xAxes.push(new am4charts.CategoryAxis());
		categoryAxis.dataFields.category = "teom";
		categoryAxis.renderer.grid.template.location = 0;
		
		
		var valueAxis = chart.yAxes.push(new am4charts.ValueAxis());
		valueAxis.renderer.inside = true;
		valueAxis.renderer.labels.template.disabled = true;
		valueAxis.min = 0;
		
		// Create series
		function createSeries(field, name, color) {
		  
		  // Set up series
		  var series = chart.series.push(new am4charts.ColumnSeries());
		  series.name = name;
		  series.dataFields.valueY = field;
		  series.dataFields.categoryX = "teom";
		  series.sequencedInterpolation = true;
		  series.fill = am4core.color(color);
		  series.stroke = am4core.color(color);
		  
		  // Make it stacked
		  series.stacked = true;
		  
		  // Configure columns
		  series.columns.template.width = am4core.percent(60);
		  series.columns.template.tooltipText = "[bold]{name}[/]\n{valueY}";
		  series.columns.template.tooltipText.color = am4core.color('#fff');
			series.tooltip.getFillFromObject = false;
		//   series.tooltip.background.fill = am4core.color("#000");
		  series.tooltip.background.fill = am4core.color(color);
		  series.tooltip.background.strokeOpacity = 0;
		  series.tooltip.pointerOrientation = "vertical";
		  series.tooltip.label.minWidth = 40;
		  series.tooltip.label.minHeight = 40;
		  series.tooltip.label.textAlign = "middle";
		  series.tooltip.label.textValign = "middle";
		
		
		
		  // Add label
		  var labelBullet = series.bullets.push(new am4charts.LabelBullet());
		  labelBullet.label.text = "{valueY}";
		  labelBullet.locationY = 0.5;
		  labelBullet.label.hideOversized = true;
		  
		  return series;
		}
		
		createSeries("score_3", "최저점", '#f7b509');
		createSeries("score_2", "평균", '#4db380');
		createSeries("score_1", "최고점", '#0080ff');
		
		
		// Make a panning cursor
		chart.cursor = new am4charts.XYCursor();
		chart.cursor.behavior = "panXY";
		
		
		
		// Legend
		chart.legend = new am4charts.Legend();
		
		
		}); // end am4core.ready()

		
    }).fail(function () {
		console.log("연간 사고원인을 불러오지 못했습니다.");
    });
}

function retestRate(){ // chartdiv_personal_1 평가시험 재시험율
	$.ajax({
        url: gblAdminPath + "/lms/vod/stat/chart/retestRate",
        type: 'GET',
        dataType: 'json',
    }).done(function (data) {
		am4core.ready(function() {
			am4core.useTheme(am4themes_animated);
			var chart = am4core.create("chartdiv_personal_1", am4charts.PieChart);
			//chart.logo.disabled = true;
			// chart.legend = new am4charts.Legend();
			// chart.legend.position = "right";
			chart.width = am4core.percent(100);
			chart.height = am4core.percent(100);
			// Add data
			chart.data = [ {
			"title": "재시험율",
			"litery": 78
			}, {
			"title": "나머지",
			"litery": 100 - 78
			}];

			// Add and configure Series
			var pieSeries = chart.series.push(new am4charts.PieSeries());
			pieSeries.dataFields.value = "litery";
			pieSeries.dataFields.category = "title";
			pieSeries.slices.template.stroke = am4core.color("#fff");
			pieSeries.slices.template.strokeWidth = 1;
			pieSeries.slices.template.strokeOpacity = 1;

			// This creates initial animation
			pieSeries.hiddenState.properties.opacity = 1;
			pieSeries.hiddenState.properties.endAngle = -90;
			pieSeries.hiddenState.properties.startAngle = -90;

			// Add label
			chart.innerRadius = 50;
			var label = chart.seriesContainer.createChild(am4core.Label);
			label.text = "78%";
			label.horizontalCenter = "middle";
			label.verticalCenter = "middle";
			label.fontSize = 24;
			label.fontWeight = 'bold';

			// Disable ticks and labels
			pieSeries.labels.template.disabled = true;
			pieSeries.ticks.template.disabled = true;

			pieSeries.colors.list = [
				// am4core.color("#7760f9"),
				am4core.color("#344678"),
				am4core.color("#2e7df4"),
				am4core.color("#1da7fa"),
				am4core.color("#6af4ff"),
			];

		});

		
    }).fail(function () {
		console.log("평균 근육 활성도를 불러오지 못했습니다.");
    });
}

function retesterAndHighScorer(){ // chartdiv_personal_2 재시험자 및 고득점자 수 비교
	$.ajax({
        url: gblAdminPath + "/lms/vod/stat/chart/retesterAndHighScorer",
        type: 'GET',
        dataType: 'json',
    }).done(function (data) {
		
		am4core.ready(function() {
			// Themes begin
			am4core.useTheme(am4themes_animated);
			// Themes end

			// Create chart instance
			var chart = am4core.create("chartdiv_personal_2", am4charts.XYChart);
			//chart.logo.disabled = true;
			
			// Add data
			chart.data = [{
			"place": "재시험자",
			"count": 4351
			}, {
			"place": "고득점자",
			"count": 1296
			}];

			// Create axes

			var categoryAxis = chart.xAxes.push(new am4charts.CategoryAxis());
			categoryAxis.dataFields.category = "place";
			categoryAxis.renderer.grid.template.disabled = true;
			categoryAxis.renderer.grid.template.location = 0;
			categoryAxis.renderer.minGridDistance = 30;
			categoryAxis.renderer.labels.template.adapter.add("dy", function(dy, target) {
			// if (target.dataItem && target.dataItem.index & 2 == 2) {
			// 	return dy + 25;
			// }
			return dy;
			});

			var valueAxis = chart.yAxes.push(new am4charts.ValueAxis());
			valueAxis.renderer.labels.template.fill = '#999';

			// Create series
			var series = chart.series.push(new am4charts.ColumnSeries());
			series.dataFields.valueY = "count";
			series.dataFields.categoryX = "place";
			series.name = "count";
			series.columns.template.tooltipText = "{categoryX}: [bold]{valueY}[/]";
			// series.columns.template.fillOpacity = .8;
			var gradient = new am4core.LinearGradient();
			// gradient.addColor(am4core.color("#006fdd"));
			gradient.addColor(am4core.color("#008ff6"));
			gradient.rotation = 90;
			series.columns.template.fill = gradient;
			series.columns.template.stroke = gradient;
			series.columns.template.strokeWidth = 0;


			}); // end am4core.ready()
		
    }).fail(function () {
		console.log("평균 근육 활성도를 불러오지 못했습니다.");
    });
}

function gapComparison(){ // chartdiv_personal_3 고득점 격차 비교 TOP 3
	$.ajax({
        url: gblAdminPath + "/lms/vod/stat/chart/gapComparison",
        type: 'GET',
        dataType: 'json',
    }).done(function (data) {
		am4core.ready(function() {
			// Themes begin
			am4core.useTheme(am4themes_animated);
			// Themes end

			var chart = am4core.create("chartdiv_personal_3", am4charts.XYChart);
			chart.padding(10, 10, 10, 10);
			//chart.logo.disabled = true;

			var categoryAxis = chart.yAxes.push(new am4charts.CategoryAxis());
			categoryAxis.renderer.grid.template.location = 0;
			categoryAxis.dataFields.category = "score_name";
			categoryAxis.renderer.labels.template.fill = '#fff';
			categoryAxis.renderer.labels.template.fontSize = 14;
			categoryAxis.renderer.minGridDistance = 1;
			categoryAxis.renderer.inversed = true;
			categoryAxis.renderer.grid.template.disabled = true;
			categoryAxis.renderer.inside=true;
			var valueAxis = chart.xAxes.push(new am4charts.ValueAxis());
			valueAxis.min = 0;
			valueAxis.max = 100;
			valueAxis.renderer.labels.template.fill = '#999';
			valueAxis.renderer.labels.template.fontSize = 12;
			valueAxis.renderer.grid.template.stroke = '#1da7fa';
			valueAxis.renderer.grid.template.strokeOpacity = 0;
			// dateAxis.renderer.maxGridDistance = 100;
			// valueAxis.renderer.inside=true;
			var series = chart.series.push(new am4charts.ColumnSeries());
			series.dataFields.categoryY = "score_name";
			series.dataFields.valueX = "count";
			series.tooltipText = "[bold]{valueX.value}[/]";
			series.columns.template.strokeOpacity = 0;
			series.columns.template.column.cornerRadiusBottomRight = 5;
			series.columns.template.column.cornerRadiusTopRight = 5;

			var labelBullet = series.bullets.push(new am4charts.LabelBullet())
			labelBullet.label.horizontalCenter = "right";
			labelBullet.label.dx = -10;
			labelBullet.label.text = "{values.valueX.workingValue.formatNumber('#점')}";
			labelBullet.label.fill = am4core.color("#fff"); // accident_name 텍스트의 색상 변경
			labelBullet.label.fontSize = 16;
			labelBullet.locationX = 0;

			var gradient = new am4core.LinearGradient();
			gradient.addColor(am4core.color("#758a9d"));
			gradient.addColor(am4core.color("#56717e"));

			// 각 바에 대한 색상을 설정하는 배열
			var barColors = [
			am4core.color("#008ff6"),
			am4core.color("#00c0a8"),
			am4core.color("#00beea"),
			// am4core.color("#a674ef"),
			// am4core.color("#a0a0a0"),
			];


			// 각 바의 색상 설정
			series.columns.template.adapter.add("fill", function(fill, target){
				return barColors[target.dataItem.index % barColors.length];
			});


			categoryAxis.sortBySeries = series;
			chart.data = [
				{
				"score_name": "최고득점",
				"count": 96
				},
				{
				"score_name": "고득점",
				"count": 87
				},
				{
				"score_name": "고득점2",
				"count": 86
				}
			]
			}); // end am4core.ready()
		
    }).fail(function () {
		console.log("평균 근육 활성도를 불러오지 못했습니다.");
    });
}	
</script>	
	
